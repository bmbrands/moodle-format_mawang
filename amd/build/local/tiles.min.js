define("format_mawang/local/tiles",["exports"],(function(_exports){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.showSection=_exports.setGridStyles=_exports.init=void 0;
/**
   * Tile controls
   *
   * @module     format_mawang/local/tiles
   * @copyright  2024 Bas Brands <bas@sonsbeekmedia.nl>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */
const setGridStyles=(tilesection,sectioncontent)=>{const alltilesections=document.querySelectorAll('[data-region="tilesection"]'),gridwidth=tilesection.closest(".tilesections").offsetWidth,tileWidth=tilesection.offsetWidth,tilesectiontotal=Math.floor(gridwidth/tileWidth);let tilesectionrow=0;alltilesections.forEach(((tile,index)=>{tile===tilesection&&(tilesectionrow=Math.floor(index/tilesectiontotal))})),sectioncontent.style.gridRow=tilesectionrow+2,sectioncontent.style.gridColumn="1 / -1"};_exports.setGridStyles=setGridStyles;const showSection=function(tiletoggle){let toggle=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const button=tiletoggle,sectionid=button.dataset.number,tilesection=document.querySelector('[data-region="tilesection"][data-number="'+sectionid+'"]'),tile=tilesection.querySelector(".tiletoggle"),sectioncontent=document.querySelector('[data-region="sectioncontent"][data-sectionid="'+sectionid+'"]'),closebutton=sectioncontent.querySelector('.btn-close[data-action="tiletoggle"]'),sectioncontents=document.querySelectorAll('[data-region="sectioncontent"]');sectioncontents.forEach((section=>{section!==sectioncontent&&section.classList.remove("show")}));const alltilesections=document.querySelectorAll('[data-region="tilesection"]');alltilesections.forEach((tile=>{tile!==tilesection&&tile.classList.remove("show")})),toggle?(sectioncontent.classList.toggle("show"),tilesection.classList.toggle("show")):(sectioncontent.classList.add("show"),tilesection.classList.add("show")),setGridStyles(tilesection,sectioncontent),"true"===tiletoggle.dataset.keypressed&&setTimeout((()=>{sectioncontent.classList.contains("show")&&closebutton?closebutton.focus():tile.focus()}),300),tiletoggle.dataset.keypressed="false"};_exports.showSection=showSection;const navigateToSection=sectionid=>{let button=document.querySelector('[data-action="tiletoggle"][data-number="'.concat(sectionid,'"]'));if(button)showSection(button,!1);else{var _subsection$closest;const subsection=document.querySelector('.course-section[data-number="'.concat(sectionid,'"]')),parentId=null==subsection||null===(_subsection$closest=subsection.closest('[data-region="sectioncontent"]'))||void 0===_subsection$closest?void 0:_subsection$closest.dataset.sectionid;parentId&&(button=document.querySelector('[data-action="tiletoggle"][data-number="'.concat(parentId,'"]')),button&&showSection(button,!1))}};_exports.init=()=>{document.addEventListener("click",(event=>{if(event.target.closest('.tilesections [data-action="tiletoggle"]')){const tiletoggle=event.target.closest('.tilesections [data-action="tiletoggle"]');showSection(tiletoggle);const sectionid=tiletoggle.dataset.number;window.location.hash="section-".concat(sectionid)}if(event.target.closest('.courseindex-link[data-for="section_title"]')){var _event$target$closest;const sectionid=null===(_event$target$closest=event.target.closest(".courseindex > .courseindex-section"))||void 0===_event$target$closest?void 0:_event$target$closest.dataset.number;sectionid&&navigateToSection(sectionid)}})),document.addEventListener("keydown",(event=>{if("Enter"===event.key&&event.target.closest('.tilesections .tiletoggle[data-action="tiletoggle"]')){const tiletoggle=event.target.closest('.tilesections .tiletoggle[data-action="tiletoggle"]');tiletoggle.dataset.keypressed="true",showSection(tiletoggle);const sectionid=tiletoggle.dataset.number;window.location.hash="section-".concat(sectionid)}})),window.addEventListener("resize",(()=>{const sectioncontent=document.querySelector('.tilesections .show[data-region="sectioncontent"]'),tilesection=document.querySelector('.tilesections .show[data-region="tilesection"]');sectioncontent&&tilesection&&setGridStyles(tilesection,sectioncontent)}));const hash=window.location.hash;if(hash){const sectionid=hash.replace("#section-","");navigateToSection(sectionid)}}}));

//# sourceMappingURL=tiles.min.js.map